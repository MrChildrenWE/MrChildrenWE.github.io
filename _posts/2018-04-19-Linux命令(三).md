---
layout:     post   				          # 使用的布局（不需要改）
title:      Linux 常用命令（三）			# 标题 
subtitle:   vim 与Shell 脚本基本使用             #副标题
date:       2018-04-19      # 时间
author:     Mr.Children						# 作者
header-img: img/1.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - Linux   
---  
#### vim 的基本使用 
###### 基本使用  
```
dd:	删除一行
dw:	删除一个单词
d3w:	删除3个单词
yy:	复制一行
3yy:	复制三行
yw:	复制一个单词
p:	粘贴到下一行
P:	粘贴到上一行
\>>:	当前行右缩进一个tab
3>>:	当前行以及后两行都缩进一个tab
3<<:	当前行以及后两行都向左缩进一个tab
/word:	查找特定单词
u:	撤销上一次操作
.:	重复上一次操作
ctral+r:	重做撤销的操作
y$:	从当前复制到行尾
d$:	从当前删除到行尾
```
###### 跳转操作  
```
gg:	跳到文件开头
G:	跳到文件结尾
zt:	当前行作为可视屏幕的第一行
5G:	跳到第五行
```
###### 冒号  
```
:5d:	删除第五行
:20,24y:	复制20到40行
:., + 3y:	复制当前行和下面三行
:2,11>:	右缩进
:w:	保存文件
:q:	退出编辑器
:vsplit:	分屏
```  
#### Shell 脚本的基本语法
###### Bash 特殊字符

1. 通配符  
```
\*:匹配任何字符
**：匹配任何字符串
*？：匹配任何单个字符
```
2. 集合运算符  
```
用一些单个字、一个连续范围或断续的字符集合作作为通配符  
[a-z]:用字符集合作通配符匹配单个字符，如：[aeiou],[a-o],[A-Z],[0-9]  
[!A-Za-z0-9]:除了集合外的所有字符组成的集合作为通配符  
```  
3. 花括号展开式（可以嵌套）  
```
c{a{r,t,n},b{r,t,n}}s可以匹配cars cats cans cbrs cbts cbns  
```  
4. 其他特殊字符:  
```
():子shell运行；比如(cd ehbio;mkdir ysx)进入ehbio 目录，新建ysx文件夹，运行完之后还在当前目录  
':强引用字符串，不解释特殊字符
":弱引用字符串，解释所有特殊字符  
;:命令分隔符（命令终止符），运行在一行里执行多条命令；一般在终端直接写判断语句或执行for循环时用  
#:行注释
$:变量表达式，变量解析&：在后台执行命令，在for 循环中也可以作为命令分隔符，取代done前面的；  
```  

###### Bash 变量  

1. 自定义变量 (字母数字下划线，等号两边无空格)  
``` 
varname=value  
在引用变量可以直接$varname 或者${varname}  
为了使变量可以在其他进程中使用，需要将变量导出：export varname   
``` 
2. 环境变量 
``` 
使用set 命令给变量赋值或者查看环境变量值，使用unset命令清除变量值，使用export 导出变量  
将可以使其他进程访问到该环境变量，可以把设置保存到.bashrc或.bash_profile中，成为永久的  
环境变量    
```
3. 位置变量   
``` 
对应于命令行参数，其中$0为脚本名称，$1为第一个参数  
参数超过9个必须使用 ${}引用变量。shell 保留这些变量  
不允许用户以另外的方式定义它们，传给脚本或函数的位置  
变量是局部和只读的，而其余变量为全局的。  
```    
4. 其他变量  
```
$?:保存前一个命令的返回码；0为运行成功，常用来判断上一个程序的退出状态  
$$:当前shell的进程号  
$!:上一个子进程的进程号  
$#:传给脚本或函数的参数个数，即位置变量数减1（1代表脚本自身）  
$*和$@:传给脚本的所有参数（不包含脚本本身），每个参数以$IFS分隔  
（一般为空格，TAB，换行）；两者的不同点是引号括起来，前者  
作为一个整体，后者还是单个的参数   
cat ehbio_testParam.sh  
#!/bin/bash  
echo "EHBIO${IFS}great" 
echo '$*' 
echo -ne "\t"; 
echo $*   
echo '$@'  
echo -ne "\t"  
echo $@  
echo 'Each element in $*:'  
for i in "$*"; do  
    echo -ne "\t";
    echo $i;
done  
echo 'Each element in $@:'  
for i in "$@"; do  
    echo -ne "\t";  
    echo $i;  
done  
#bash ehbio_testParam.sh sheng xin bao dian  
```  

###### Bash 操作符  

1. 字符串操作符（替换操作符）  
```  
${var:-word}: 如果 var 存在且不为空, 返回它的值, 否则返回 word   
${var:=word}: 如果 var 存在且不为空, 返回它的值, 否则将 word 赋给 var, 返回它的值 
${var:+word}: 如果 var 存在且不为空, 返回 word, 否则返回空 
${var:?message}如果 var 存在且不为空, 返回它的值,   
否则显示 “-bash: var: message”, 然后退出当前命令或脚本 
${var:offset[:length]}从 offset 位置开始返回 var 的一个长为   
length 的子串, 若没有 length, 则默认到 var 串末尾  
echo ${var:?message}  
var = 'sheng xin bao dian'   
echo ${var:6:3}  #第六个开始截取3个  
echo ${var:?message}  
```   

2. 匹配模式操作符  
```  
${var#pattern}从 var 头部开始, 删除和 pattern 匹配的最短模式串, 然后返回剩余串  
${var##pattern} 从 var 头部开始, 删除和 pattern 匹配的最长模式串, 然后返回剩余串, basename path ＝ ${path##*/}    
${var%pattern}从var尾部开始,删除和pattern匹配的最短模式串,然后返回剩余串,dirname path ＝ ${path%/ *}  
${var%%pattern}从 var 尾部开始, 删除和 pattern 匹配的最长模式串, 然后返回剩余串
${var/pattern/string}用 string 替换 var 中和 pattern 匹配的最长模式串
```  
获取fastaq文件的名字部分  
`for i in `ls *_1.fq.gz`; do j=${i/_1.fq.gz/}; echo "$j"; done`  

###### Shell 中条件和test命令  

1. 文件测试操作符  
```  
-d file: file 存在并且是一个目录   
-e file: file 存在   
-f file: file 存在并且是一个普通文件   
-g file: file 存在并且是 SGID(设置组 ID) 文件   
-r file: 对 file 有读权限   
-s file: file 存在并且不为空   
-u file: file 存在并且是 SUID(设置用户 ID) 文件   
-w file: 对 file 有写权限   
-x file: 对 file 有执行权限, 如果是目录则有查找权限   
-O file: 拥有 file   
-G file: 测试是否是 file 所属组的一个成员   
-L file: file 为符号链接   
file1 –nt file2: file1 比 file2 新  
file1 –ot file2: file1 比 file2 
```      

2. 字符串操作  
```
str1=str2   #匹配  
str1!=str2  #不匹配  
str1>str2   #str1大于str2  
-n strstr 的长度大于 0（不为空）-z strstr 的长度为 0（空串），  
常用于判断必须的命令行参数是否传入
#字符串的大小比较的是最先遇到的不同的ASCII码的大小   
if test "10">"20"; then echo "10>20"; fi  if test 10>20; then echo "10 < 20"; fi
```    

3. 整数操作符   
```
var1 –eq var2 var1 等于 var2 
var1 –ne var2 var1 不等于 var2 
var1 –ge var2 var1 大于等于 var2 
var1 –gt var2 var1 大于 var2 
var1 –le var2 var1 小于等于 var2 
var1 –lt var2 var1 小于 var2  
ge: great equal;gt: great than
#数学表达式也可以  
if (( 3>2 )); then echo 'TRUE'; fi 
```      

4. 逻辑操作符   
```  
!expr对 expr 求反  
expr1 && expr2对 expr1 与 expr2 求逻辑与, 当 expr1 为假时不再执行 expr2   
expr1 || expr2对 expr1 与 expr2 求逻辑或, 当 expr1 为真时不再执行 expr2  
```  

###### Shell 控制流   

1. 条件语句：if  
```   
if,then,elif,else,fi是关键词其他的是要替换掉的  
if conditions; then  
    do sth when conditions are true  
elif another_conditions; then  
    do sth when another_conditions are true  
else:  
    do sth when above conditions are all false  
fi  
if test $guanzhu_sxbd == "already"; then  
    echo "Enjoy it"  
elif test $guanzhu_hjyz == "already"; then  
    echo "Enjoy it"  
else
    echo "Guanzhu them"  
fi 
```  

2. 确定性循环：for do done常用的批量操作方式  
遍历一个列表，取出每个元素，针对性操作    
```
for i in a; do  
    echo "$i";
done
```    

3. 不确定性循环:while 和until   
```
declare -i a    #定义整数变量  
a=1 #初始化变量  
while test $a -lt 3; do #小于则为真 
    echo $a  
    a=$a+1  
done  
echo $a
```    
4. 选择结构：case和select(类似getopts)   
5. 命令 shift   

###### Shell 函数   

```
cat test_func.sh  
function show_ehbio()  {
    echo $@  
    echo $1
} 
show_ehbio "EHBIO great" "SXBD great"  
bash test_func.sh
```    

###### 输入输出  

1. I/O 重定向      
```      
<:输入重定向        
>:输出重定向(没有文件则创建，有则覆盖)        
>>:输出重定向(没有则创建，有则追加到文件尾部)        
<<:输入重定向    
```     

2. 字符串 I/O 操作        
字符串输出：echo        
首选项命令: -e:启动转义序列 -n:取消输出后换行        
3. 字符串输入：read可以用于用户交互输入，也可以用来          
一次处理文本文件中的一行




