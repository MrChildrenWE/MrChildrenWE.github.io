---
layout:     post   				    # 使用的布局（不需要改）
title:      基因预测与比对				# 标题 
subtitle:   GeneMarks、glimmer3 与blast+ 的使用 #副标题
date:       2018-05-18			# 时间
author:     Mr.Children						# 作者
header-img: img/post-bg-2015.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - 生信软件
---

> 常用的原核生物基因预测软件有GeneMarks、Glimmer3、RAST

#### 使用GeneMarks 进行原核生物基因的预测  
###### 1. GeneMarks 的下载和安装
```
wget http://topaz.gatech.edu/GeneMark/tmp/GMtool_aQKBZ/genemark_suite_linux_64.tar.gz  
tar -zxvf genemark_suite_linux_64.tar.gz -C ~/tools/  
##添加环境变量  
vim ~/.bashrc  
export PATH=/home/wei/tools/gmsuite/:$PATH  
source ~/.bashrc  
## 添加密钥  
gzip -dv gm_key_64.gz  
mv gm_key_64 ~/.gm_key
```
###### 2. GeneMarks 的使用  
`gmsn.pl --prok --format GFF --pdf --fnn --faa YP14.assembly.fasta`
```
--output <string> 输出基因预测的结果文件，默认为输入的文件名
--prok 对原核生物序列进行基因预测
--format 输出的基因预测结果的格式文件，默认为LTS，还可以GFF，GFF3
--pdf 生成pdf 的图形结果
--fnn 生成预测基因的核酸序列
--faa 生成预测基因的氨基酸序列
```
输出的文件有.faa .fnn .gff .pdf 等文件，以方便下一步的比对工作  
#### glimmer3 的使用   
Glimmer是用于寻找微生物DNA，特别是细菌、古菌和病毒中的基因。  
其采用的方法为内插马尔科夫模型（interpolted Markov model，IMM）  
来识别编码区域和非编码区域    
###### 1. glimmer3 的下载与安装  
```
wget http://ccb.jhu.edu/software/glimmer/glimmer302b.tar.gz  
tar -zxvf glimmer302b.tar.gz -C ~/tools/  
cd ~/tools/glimmer3.02/src  
sudo make  
vim ~/.bashrc
export PATH=/home/wei/tools/glimmer3.02/bin/:$PATH
source ~/.bashrc
```  
###### 2. 使用方法  
创建训练模型：  
a. 用亲缘关系很近的物种的基因；  
b. 用自身序列创建的orf数据；  
c. 用基因组本身的已知信息；  
下面用的自身数据作为训练集   
1. 产生长orf 数据   
```  
long-orfs -n -t 1.15 YP14.seq run.longorfs  
-n 输出文件去除首行，只包含orf  
-t 熵距离得分阈值，小于阈值才被保留
```    
2. 提取数据集   
`extract -t YP14.seq run.longorfs > run.train`   
3. 生成预测模型   
`build-icm -r run.icm < run.train`  
4. 基因预测  
```  
glimmer3 -o50 -g110 -t30 YP14.seq run.icm run  
-o 最大重叠片段长度阈值，小于阈值保留  
-g 基因片段长度阈值，大于阈值则保留  
-t orf得分阈值，大于阈值保留 
```
5. 根据预测结果提取序列   
`extract -t YP14.seq run.predict > predict.fasta`  

#### ncbi-blast+ 的使用
###### 1. ncbi-blast+ 的下载安装  
下载地址:  `ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.8.0alpha/ `
###### 2. 建立库文件
下载Swiss-Prot 的蛋白序列并构建Blast 数据库：  
`wget ftp://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.fasta.gz`
 `gzip -d uniprot_sprot.fasta.gz`

建立数据库：  
`makeblastdb -in uniprot.fasta -dbtype prot -parse_seqids -hash_index -out uniprot`
```
-in 输入数据库文件
-dbtype 蛋白库用prot,核酸用nucl
-out 所建数据库的名称
-parse_seqids      
-hash_index 创建哈希序列
```  
将数据库的文件加入到特定位置  
```
vim ~/.ncbirc  
[BLAST]
#BLAST数据库的存放位置
BLASTDB=/home/wei/database/
#BLASTDB_PROT_DATA_LOADER=//home/wei/database
#BLASTDB_NUCL_DATA_LOADER=//home/wei/database  
```  
查看数据库信息  
```
blastdbcmd -db 16SMicrobial -dbtype nucl -info  
blastdbcmd -db 16SMicrobial -dbtype nucl -entry all | head  
blastdbcmd -db 16SMicrobial -dbtype nucl -entry NR_118889.1 | head
```  
###### 3. 数据的比对 
`blastp -query pritein.fasta -db uniprot -evalue 1e-5 -out blast.xml -outfmt 5 -num_alignments 10 -num_threads 4 [-remote]`  
参数说明：  
```
-query 输入要比对的文件路径
-db 格式化后的数据库名称
-evalue 设定输出结果中的e-value阈值
-out 输出文件名
-num_alignments 输出比对上的序列的最大值条目数
-num_threads 线程数
-num_descriptions 序列描述信息，一般跟tabular格式连用
-remote 在联网状态下会利用NCBI的服务器来进行比对
-outfmt      
 0 = pairwise,
 1 = query-anchored showing identities,
 2 = query-anchored no identities,
 3 = flat query-anchored, show identities,
 4 = flat query-anchored, no identities,
 5 = XML Blast output,输出的信息最全
 6 = tabular,表格的格式
 7 = tabular with comment lines,
 8 = Text ASN.1,
 9 = Binary ASN.1
 10 = Comma-separated values
 ```
